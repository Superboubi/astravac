(()=>{var e={};e.id=427,e.ids=[427],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},9820:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},1149:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var t=r(482),a=r(9108),i=r(2563),l=r.n(i),n=r(8300),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(s,o);let d=["",{children:["admin",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4381)),"/Users/saill/Desktop/Premium cursor Astra/src/app/admin/dashboard/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1342)),"/Users/saill/Desktop/Premium cursor Astra/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/saill/Desktop/Premium cursor Astra/src/app/admin/dashboard/page.tsx"],u="/admin/dashboard/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/dashboard/page",pathname:"/admin/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6407:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},4592:(e,s,r)=>{Promise.resolve().then(r.bind(r,154))},5826:()=>{},154:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>o});var t=r(5344),a=r(8428),i=r(3729),l=r(9835),n=r(7430);function o(){let e=(0,a.useRouter)(),[s,r]=(0,i.useState)([]),[o,d]=(0,i.useState)(""),[c,u]=(0,i.useState)(null),[m,x]=(0,i.useState)(!0),[h,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{let{data:{session:s}}=await n.O.auth.getSession();if(!s){e.push("/auth/login");return}let{data:r,error:t}=await n.O.from("users").select("role").eq("id",s.user.id).single();if(t||r?.role!=="admin"){e.push("/dashboard");return}g()})()},[e]);let g=async()=>{try{x(!0),p(null);let{data:e,error:s}=await n.O.from("users").select("*").order("created_at",{ascending:!1});if(s)throw s;let{data:t,error:a}=await n.O.from("folders").select("*");if(a)throw a;let{data:i,error:l}=await n.O.from("photos").select("*");if(l)throw l;let o=e.map(e=>{let s=t.filter(s=>s.user_id===e.id),r=i.filter(s=>s.user_id===e.id);return{...e,folders:s.map(e=>({...e,photoCount:r.filter(s=>s.folder_id===e.id).length,lastModified:new Date(e.updated_at).toLocaleDateString(),photos:r.filter(s=>s.folder_id===e.id).map(e=>({...e,uploaded_at:new Date(e.uploaded_at).toLocaleDateString()}))}))}});r(o)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e),p("Erreur lors du chargement des donn\xe9es")}finally{x(!1)}},f=s.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase())),v={totalUsers:s.length,totalFolders:s.reduce((e,s)=>e+s.folders.length,0),totalPhotos:s.reduce((e,s)=>e+s.folders.reduce((e,s)=>e+s.photoCount,0),0),recentUsers:s.filter(e=>{let s=new Date(e.created_at),r=new Date;return r.setDate(r.getDate()-30),s>=r}).length};return m?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(l.N,{}),t.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-64px)]",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})]}):h?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(l.N,{}),t.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-64px)]",children:t.jsx("div",{className:"text-red-500",children:h})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(l.N,{}),(0,t.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[t.jsx("div",{className:"py-6",children:t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de bord administrateur"})}),t.jsx("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Rechercher un utilisateur...",value:o,onChange:e=>d(e.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2 pl-10 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"}),t.jsx("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[t.jsx("div",{className:"cursor-pointer rounded-lg bg-white p-6 shadow transition-all hover:shadow-md",onClick:()=>e.push("/admin/users"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:t.jsx("svg",{className:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs totaux"}),t.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.totalUsers})]})]})}),t.jsx("div",{className:"cursor-pointer rounded-lg bg-white p-6 shadow transition-all hover:shadow-md",onClick:()=>e.push("/admin/users"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"rounded-full bg-green-100 p-3",children:t.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-600",children:"Dossiers totaux"}),t.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.totalFolders})]})]})}),t.jsx("div",{className:"cursor-pointer rounded-lg bg-white p-6 shadow transition-all hover:shadow-md",onClick:()=>e.push("/admin/users"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"rounded-full bg-yellow-100 p-3",children:t.jsx("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-600",children:"Photos totales"}),t.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.totalPhotos})]})]})}),t.jsx("div",{className:"cursor-pointer rounded-lg bg-white p-6 shadow transition-all hover:shadow-md",onClick:()=>e.push("/admin/users"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"rounded-full bg-purple-100 p-3",children:t.jsx("svg",{className:"h-6 w-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,t.jsxs)("div",{className:"ml-4",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-600",children:"Nouveaux utilisateurs (30j)"}),t.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:v.recentUsers})]})]})})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Utilisateurs r\xe9cents"}),t.jsx("button",{onClick:()=>e.push("/admin/users"),className:"text-sm font-medium text-blue-600 hover:text-blue-500",children:"Voir tout"})]}),t.jsx("div",{className:"mt-4 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:f.slice(0,6).map(s=>t.jsx("div",{className:"cursor-pointer rounded-lg bg-white p-6 shadow transition-all hover:shadow-md",onClick:()=>e.push(`/admin/users/${s.id}`),children:(0,t.jsxs)("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center",children:t.jsx("span",{className:"text-xl font-medium text-gray-600",children:s.name.charAt(0)})})}),(0,t.jsxs)("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:s.name}),t.jsx("p",{className:"text-sm text-gray-500",children:s.email}),(0,t.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500",children:[t.jsx("svg",{className:"mr-1.5 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),s.folders.length," dossiers"]})]})]})},s.id))})]})]})]})}},9835:(e,s,r)=>{"use strict";r.d(s,{N:()=>l});var t=r(5344),a=r(8428),i=r(6506);function l(){let e=(0,a.useRouter)();return t.jsx("nav",{className:"bg-white shadow",children:t.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex h-16 justify-between",children:[(0,t.jsxs)("div",{className:"flex",children:[t.jsx("div",{className:"flex flex-shrink-0 items-center",children:t.jsx("span",{className:"text-xl font-bold text-blue-600",children:"Admin Panel"})}),(0,t.jsxs)("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[t.jsx(i.default,{href:"/admin/dashboard",className:"inline-flex items-center border-b-2 border-blue-500 px-1 pt-1 text-sm font-medium text-gray-900",children:"Tableau de bord"}),t.jsx(i.default,{href:"/admin/users",className:"inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"Utilisateurs"})]})]}),t.jsx("div",{className:"flex items-center",children:t.jsx("button",{onClick:()=>{localStorage.removeItem("isAuthenticated"),localStorage.removeItem("userRole"),localStorage.removeItem("userName"),e.push("/auth/login")},className:"rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",children:"D\xe9connexion"})})]})})})}},7430:(e,s,r)=>{"use strict";r.d(s,{O:()=>i});var t=r(3125);let a={supabase:{url:"https://igeaimikswzxnaduekrr.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnZWFpbWlrc3d6eG5hZHVla3JyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI4OTQ2OTMsImV4cCI6MjA1ODQ3MDY5M30.S3osZcB9x8ygSDDMOfTxvvUHoxAbL1zlQNY70uLVrJA"}},i=(0,t.eI)(a.supabase.url,a.supabase.anonKey)},4381:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>i,__esModule:()=>a,default:()=>l});let t=(0,r(6843).createProxy)(String.raw`/Users/saill/Desktop/Premium cursor Astra/src/app/admin/dashboard/page.tsx`),{__esModule:a,$$typeof:i}=t,l=t.default},1342:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>n,metadata:()=>l});var t=r(5036),a=r(2195),i=r.n(a);r(5023);let l={title:"Photo Gallery App",description:"Une application moderne pour g\xe9rer vos photos"};function n({children:e}){return t.jsx("html",{lang:"fr",children:t.jsx("body",{className:i().className,children:t.jsx("main",{className:"min-h-screen bg-gray-50",children:e})})})}},5023:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[479,476,833],()=>r(1149));module.exports=t})();